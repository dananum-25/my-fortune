/* ===============================
   BASE
================================ */
*{ box-sizing:border-box; }

body{
  margin:0;
  background:#0b0b0f;
  color:#fff;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
}

body.lock-scroll{ overflow:hidden; }

.hidden{ display:none !important; }

/* ===============================
   TOP BAR
================================ */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 14px;
}

.brand{
  font-weight:800;
  letter-spacing:.2px;
}

#soundToggle{
  font-size:14px;
  padding:8px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.06);
  color:#fff;
}

/* ===============================
   QUESTION HERO (고양이 + 질문)
================================ */
.cat-area{
  text-align:center;
  padding:14px 16px 6px;
}

.cat-image{
  display:block;
  width:100%;
  max-width:420px;
  margin:0 auto 14px;
  border-radius:18px;
}

#catText{
  margin:10px 0 14px;
  font-size:26px;
  line-height:1.25;
  font-weight:900;
  letter-spacing:-0.4px;
}

/* ===============================
   QUESTION BUTTONS (큰 버튼)
================================ */
#questionArea{ margin-top:10px; }

#questionArea button{
  display:block;
  width:100%;
  margin:12px 0;
  padding:20px 16px;
  border-radius:18px;
  border:none;
  background:#1e1e2a;
  color:#fff;
  font-size:20px;
  font-weight:800;
  letter-spacing:-0.3px;
  transition:transform .15s ease, background .15s ease;
}

#questionArea button:active{
  transform:scale(0.97);
  background:#2a2a3a;
}

/* ===============================
   TRANSITION
================================ */
.transition{
  padding:14px;
  text-align:center;
}

.transition p{
  font-size:20px;
  font-weight:800;
  margin:10px 0 14px;
}

.transition button{
  width:100%;
  padding:18px;
  border-radius:16px;
  border:none;
  background:#f5f5f7;
  color:#111;
  font-size:18px;
  font-weight:900;
}

/* ===============================
   BIG CARD STAGE
   ✅ 핵심: sticky 안에서 reorderStage를 absolute로 고정
================================ */
.tarot-stage{
  padding:8px 10px 0;
}

#bigCardStage{
  position: sticky;
  top: 0;
  z-index: 40;
  padding-top: 8px;
  pointer-events: none;


  /* ✅ reorderStage가 들어갈 공간 확보(겹침 방지) */
  padding-bottom: 170px;

  /* ✅ absolute 자식 기준점 */
  overflow: visible;

  background: radial-gradient(circle at top,
    rgba(0,0,0,.6),
    rgba(0,0,0,0));
}

.big-cards{
  position:relative;
  width:100%;
  max-width:420px;
  aspect-ratio:3 / 4;
  margin:8px auto 0;
}

/* 기본 카드 */
.big-card{
  position:absolute;
  width:32vw;
  max-width:140px;
  aspect-ratio:2 / 3;
  border-radius:14px;
  background:url("/assets/tarot/back.png") center / 100% 100% no-repeat;
  filter:drop-shadow(0 10px 22px rgba(0,0,0,.55));
  backface-visibility:hidden;
}

/* 슬롯 위치 */
.slot-2{ left:0%;   top:0%; }
.slot-1{ left:33%;  top:0%; }
.slot-3{ left:66%;  top:0%; }
.slot-6{ left:33%;  top:32%; }
.slot-4{ left:0%;   top:64%; }
.slot-7{ left:33%;  top:64%; }
.slot-5{ left:66%;  top:64%; }

/* 버전별 크기 */
.big-cards.v3-layout .big-card{ width:36%; }
.big-cards.v5-layout .big-card{ width:32%; }
.big-cards.v7-layout .big-card{ width:30%; }

.big-cards.v1-layout .big-card{
  width:60%;
  left:20%!important;
  top:18%!important;
}

/* ===============================
   REORDER STAGE
   ✅ bigCardStage 내부에 "고정" (absolute)
   - 좌표가 항상 안정적으로 잡힘
================================ */
#reorderStage{
  position: absolute;
  left: 50%;
  bottom: 14px;              /* ✅ 빅카드 아래쪽에 딱 붙임 */
  transform: translateX(-50%);
  width: 100%;
  max-width: 420px;
  pointer-events: none;
  z-index: 45;               /* ✅ bigCardStage 위 */
}

/* 재정렬 카드 캔버스 */
#reorderStage .reorder-cards{
  position: relative;
  width: 100%;
  max-width: 320px;
  aspect-ratio: 3 / 4;
  margin: 0 auto;
}

/* 재정렬 카드 */
.reorder-card{
  position: absolute;
  width: 14%;
  aspect-ratio: 2 / 3;
  background: url("/assets/tarot/back.png") center / contain no-repeat;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,.45));
  opacity: 0;
}

/* 슬롯 좌표: 2 1 3 / . 6 . / 4 7 5 */
.reorder-card.slot-2{ left: 0%;   top: 0%; }
.reorder-card.slot-1{ left: 33%;  top: 0%; }
.reorder-card.slot-3{ left: 66%;  top: 0%; }
.reorder-card.slot-6{ left: 33%;  top: 32%; }
.reorder-card.slot-4{ left: 0%;   top: 64%; }
.reorder-card.slot-7{ left: 33%;  top: 64%; }
.reorder-card.slot-5{ left: 66%;  top: 64%; }

/* ===============================
   PICKER (78장)
   ✅ sticky 아래로 충분히 떨어지게 함
================================ */
.picker{
  padding:8px 12px 0;
}

.picker-title{
  margin:10px 0 8px;
  font-size:26px;
  font-weight:900;
  letter-spacing:-.4px;
}

.grid78{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:8px;
}

.pick{
  width:100%;
  aspect-ratio:2 / 3;
  background:url("/assets/tarot/back.png") center / contain no-repeat;
  border-radius:10px;
  transition:transform .25s ease, opacity .35s ease;
}

.pick.sel{
  outline:2px solid gold;
  outline-offset:2px;
  transform:translateY(-2px);
}

.pick.fade{
  opacity:0;
  transform:scale(.85);
}

/* ✅ 겹침 방지: bigCardStage(sticky) 높이만큼 내려줌 */
#spreadSection{
  position: relative;
  z-index: 1;
  margin-top: 16px;
}

/* ===============================
   CONFIRM MODAL
================================ */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:9999;
}

.modal-card{
  width:min(86vw,360px);
  background:#1a1a1f;
  padding:18px;
  border-radius:16px;
  text-align:center;
  border:1px solid rgba(255,255,255,.1);
}

.modal-card button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  background:#f5f5f7;
  color:#111;
  font-weight:900;
}

/* ===============================
   REORDER FLY (✅ 중간 이동 연출 보이게)
================================ */
.reorder-fly{
  position: fixed;
  background: url("/assets/tarot/back.png") center/contain no-repeat;
  border-radius: 10px;
  transition: transform 2.8s cubic-bezier(.22,.61,.36,1);
  z-index: 9999;
  pointer-events: none;
}

/* ===============================
   FIRE EFFECT
================================ */
.fireball{
  position:fixed;
  width:42px;
  height:42px;
  border-radius:50%;
  background:radial-gradient(circle,
    #fff1c1,
    #ffb703,
    #ff5400,
    #b5179e);
  box-shadow:
    0 0 25px rgba(255,180,0,.9),
    0 0 45px rgba(255,80,0,.8);
  z-index:100000;
  pointer-events:none;
}

.big-card.burning::before{
  content:"";
  position:absolute;
  inset:-20%;
  background:radial-gradient(circle,
    rgba(255,200,80,.9),
    rgba(255,120,0,.7),
    transparent 70%);
  animation:burnPulse 2s ease-in-out forwards;
  border-radius:18px;
}

@keyframes burnPulse{
  0%{ opacity:.3; }
  100%{ opacity:.8; }
}

/* ===============================
   CHAT
================================ */
.chat{ padding:14px; }

.reading-result{
  margin-top:10px;
  padding:14px;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.1);
  border-radius:16px;
}
